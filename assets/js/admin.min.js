!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){
/*!
 * clipboard.js v2.0.4
 * https://zenorocha.github.io/clipboard.js
 * 
 * Licensed MIT Â© Zeno Rocha
 */
var r;r=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=l(n(1)),a=l(n(3)),s=l(n(4));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.resolveOptions(n),r.listenClick(t),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===r(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,s.default)(t,"click",(function(t){return e.onClick(t)}))}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new o.default({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return u("action",t)}},{key:"defaultTarget",value:function(t){var e=u("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return u("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach((function(t){n=n&&!!document.queryCommandSupported(t)})),n}}]),e}(a.default);function u(t,e){var n="data-clipboard-"+t;if(e.hasAttribute(n))return e.getAttribute(n)}t.exports=c},function(t,e,n){"use strict";var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(2),s=(r=a)&&r.__esModule?r:{default:r},l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.resolveOptions(e),this.initSelection()}return o(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,s.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,s.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":i(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=l},function(t,e){t.exports=function(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var r=window.getSelection(),i=document.createRange();i.selectNodeContents(t),r.removeAllRanges(),r.addRange(i),e=r.toString()}return e}},function(t,e){function n(){}n.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function i(){r.off(t,i),e.apply(n,arguments)}return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],i=[];if(r&&e)for(var o=0,a=r.length;o<a;o++)r[o].fn!==e&&r[o].fn._!==e&&i.push(r[o]);return i.length?n[t]=i:delete n[t],this}},t.exports=n},function(t,e,n){var r=n(5),i=n(6);t.exports=function(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!r.string(e))throw new TypeError("Second argument must be a String");if(!r.fn(n))throw new TypeError("Third argument must be a Function");if(r.node(t))return function(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}(t,e,n);if(r.nodeList(t))return function(t,e,n){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,n)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,n)}))}}}(t,e,n);if(r.string(t))return function(t,e,n){return i(document.body,t,e,n)}(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var n=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},function(t,e,n){var r=n(7);function i(t,e,n,r,i){var a=o.apply(this,arguments);return t.addEventListener(n,a,i),{destroy:function(){t.removeEventListener(n,a,i)}}}function o(t,e,n,i){return function(n){n.delegateTarget=r(n.target,e),n.delegateTarget&&i.call(t,n)}}t.exports=function(t,e,n,r,o){return"function"==typeof t.addEventListener?i.apply(null,arguments):"function"==typeof n?i.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return i(t,e,n,r,o)})))}},function(t,e){var n=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var r=Element.prototype;r.matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}t.exports=function(t,e){for(;t&&t.nodeType!==n;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}}])},t.exports=r()},function(t,e,n){var r,i,o,a;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */a=function(t){var e=Object.prototype.toString,n=Array.isArray||function(t){return"[object Array]"===e.call(t)};function r(t){return"function"==typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(t,e){return null!=t&&"object"==typeof t&&e in t}var a=RegExp.prototype.test,s=/\S/;function l(t){return!function(t,e){return a.call(t,e)}(s,t)}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},u=/\s*/,d=/\s+/,h=/\s*=/,p=/\s*\}/,f=/#|\^|\/|>|\{|&|=|!/;function m(t){this.string=t,this.tail=t,this.pos=0}function g(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function y(){this.cache={}}m.prototype.eos=function(){return""===this.tail},m.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},m.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},g.prototype.push=function(t){return new g(t,this)},g.prototype.lookup=function(t){var e,n,i,a=this.cache;if(a.hasOwnProperty(t))e=a[t];else{for(var s,l,c,u=this,d=!1;u;){if(t.indexOf(".")>0)for(s=u.view,l=t.split("."),c=0;null!=s&&c<l.length;)c===l.length-1&&(d=o(s,l[c])||(n=s,i=l[c],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(i))),s=s[l[c++]];else s=u.view[t],d=o(u.view,t);if(d){e=s;break}u=u.parent}a[t]=e}return r(e)&&(e=e.call(this.view)),e},y.prototype.clearCache=function(){this.cache={}},y.prototype.parse=function(e,r){var o=this.cache,a=e+":"+(r||t.tags).join(":"),s=o[a];return null==s&&(s=o[a]=function(e,r){if(!e)return[];var o,a,s,c=!1,g=[],y=[],v=[],b=!1,w=!1,_="",$=0;function k(){if(b&&!w)for(;v.length;)delete y[v.pop()];else v=[];b=!1,w=!1}function x(t){if("string"==typeof t&&(t=t.split(d,2)),!n(t)||2!==t.length)throw new Error("Invalid tags: "+t);o=new RegExp(i(t[0])+"\\s*"),a=new RegExp("\\s*"+i(t[1])),s=new RegExp("\\s*"+i("}"+t[1]))}x(r||t.tags);for(var S,E,T,A,j,I,L=new m(e);!L.eos();){if(S=L.pos,T=L.scanUntil(o))for(var C=0,N=T.length;C<N;++C)l(A=T.charAt(C))?(v.push(y.length),_+=A):(w=!0,c=!0,_+=" "),y.push(["text",A,S,S+1]),S+=1,"\n"===A&&(k(),_="",$=0,c=!1);if(!L.scan(o))break;if(b=!0,E=L.scan(f)||"name",L.scan(u),"="===E?(T=L.scanUntil(h),L.scan(h),L.scanUntil(a)):"{"===E?(T=L.scanUntil(s),L.scan(p),L.scanUntil(a),E="&"):T=L.scanUntil(a),!L.scan(a))throw new Error("Unclosed tag at "+L.pos);if(j=">"==E?[E,T,S,L.pos,_,$,c]:[E,T,S,L.pos],$++,y.push(j),"#"===E||"^"===E)g.push(j);else if("/"===E){if(!(I=g.pop()))throw new Error('Unopened section "'+T+'" at '+S);if(I[1]!==T)throw new Error('Unclosed section "'+I[1]+'" at '+S)}else"name"===E||"{"===E||"&"===E?w=!0:"="===E&&x(T)}if(k(),I=g.pop())throw new Error('Unclosed section "'+I[1]+'" at '+L.pos);return function(t){for(var e,n=[],r=n,i=[],o=0,a=t.length;o<a;++o)switch((e=t[o])[0]){case"#":case"^":r.push(e),i.push(e),r=e[4]=[];break;case"/":i.pop()[5]=e[2],r=i.length>0?i[i.length-1][4]:n;break;default:r.push(e)}return n}(function(t){for(var e,n,r=[],i=0,o=t.length;i<o;++i)(e=t[i])&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(r.push(e),n=e));return r}(y))}(e,r)),s},y.prototype.render=function(t,e,n,r){var i=this.parse(t,r),o=e instanceof g?e:new g(e);return this.renderTokens(i,o,n,t,r)},y.prototype.renderTokens=function(t,e,n,r,i){for(var o,a,s,l="",c=0,u=t.length;c<u;++c)s=void 0,"#"===(a=(o=t[c])[0])?s=this.renderSection(o,e,n,r):"^"===a?s=this.renderInverted(o,e,n,r):">"===a?s=this.renderPartial(o,e,n,i):"&"===a?s=this.unescapedValue(o,e):"name"===a?s=this.escapedValue(o,e):"text"===a&&(s=this.rawValue(o)),void 0!==s&&(l+=s);return l},y.prototype.renderSection=function(t,e,i,o){var a=this,s="",l=e.lookup(t[1]);if(l){if(n(l))for(var c=0,u=l.length;c<u;++c)s+=this.renderTokens(t[4],e.push(l[c]),i,o);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(t[4],e.push(l),i,o);else if(r(l)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(e.view,o.slice(t[3],t[5]),(function(t){return a.render(t,e,i)})))&&(s+=l)}else s+=this.renderTokens(t[4],e,i,o);return s}},y.prototype.renderInverted=function(t,e,r,i){var o=e.lookup(t[1]);if(!o||n(o)&&0===o.length)return this.renderTokens(t[4],e,r,i)},y.prototype.indentPartial=function(t,e,n){for(var r=e.replace(/[^ \t]/g,""),i=t.split("\n"),o=0;o<i.length;o++)i[o].length&&(o>0||!n)&&(i[o]=r+i[o]);return i.join("\n")},y.prototype.renderPartial=function(t,e,n,i){if(n){var o=r(n)?n(t[1]):n[t[1]];if(null!=o){var a=t[6],s=t[5],l=t[4],c=o;return 0==s&&l&&(c=this.indentPartial(o,l,a)),this.renderTokens(this.parse(c,i),e,n,c)}}},y.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},y.prototype.escapedValue=function(e,n){var r=n.lookup(e[1]);if(null!=r)return t.escape(r)},y.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="3.1.0",t.tags=["{{","}}"];var v=new y;return t.clearCache=function(){return v.clearCache()},t.parse=function(t,e){return v.parse(t,e)},t.render=function(t,e,r,i){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(n(o=t)?"array":typeof o)+'" was given as the first argument for mustache#render(template, view, partials)');var o;return v.render(t,e,r,i)},t.to_html=function(e,n,i,o){var a=t.render(e,n,i);if(!r(o))return a;o(a)},t.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,(function(t){return c[t]}))},t.Scanner=m,t.Context=g,t.Writer=y,t},e&&"string"!=typeof e.nodeName?a(e):(i=[e],void 0===(o="function"==typeof(r=a)?r.apply(e,i):r)||(t.exports=o))},function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(2);var r=n(0),i=n.n(r);class o{constructor(t){this.$body=$("body"),this.$el=$(t),this.$icon=$("<div>").text("Copied").css({position:"absolute",left:0,top:0,background:"#000000",color:"#ffffff",zIndex:1e6,padding:"0.25rem 0.5rem",borderRadius:"3px",border:"1px solid #ffffff",fontSize:"0.8rem"}),this.clipboardJs=new i.a(t),this.clipboardJs.on("success",t=>{this.showIcon(),t.clearSelection()})}showIcon(){this.$icon.remove(),this.$body.append(this.$icon);this.calcOffsetTop();this.$icon.css({opacity:0,left:this.calcOffsetLeft(),top:this.calcOffsetTop()}).animate({opacity:1},100).delay(250).animate({opacity:0},250),setTimeout(()=>{this.$icon.remove()},600)}calcOffsetLeft(){return this.$el.offset().left+this.$el.outerWidth()/2-this.$icon.outerWidth()/2}calcOffsetTop(){return this.$el.offset().top-this.$icon.outerHeight()-5}}var a=class{constructor(t){$(document).on("admin:js-copy-to-clipboard",(t,e)=>{$(e).addClass("js-copy-to-clipboard--initiated").each((t,e)=>{$(e).data("clipboardjs")||$(e).data("clipboardjs",new o(e))})}),t.onRefreshUi(()=>{$(document).trigger("admin:js-copy-to-clipboard",[".js-copy-to-clipboard"])})}};var s=class{constructor(){return $(document).on("click",".btn-disabled",()=>!1),this}};var l=class{constructor(t){return t.onRefreshUi(()=>{$(".js-admin-dynamic-table:not(.ready)").addClass("ready").each((t,e)=>{this.init($(e))})}),this}init(t){t.trigger("dynamic-table:starting");let e=t.find(".js-admin-dynamic-table__template"),n=t.data("data")||[];t.data("template",e.html()),t.data("index",0),e.empty(),this.bindEvents(t,e);for(let r=0,i=n.length;r<i;r++)this.add(t,e,n[r]);return t.trigger("dynamic-table:ready"),this}bindEvents(t,e){return $(".js-admin-dynamic-table__add",t).on("click",()=>(this.add(t,e),!1)),t.on("click",".js-admin-dynamic-table__remove",e=>(this.remove(t,$(e.currentTarget).closest("tr")),!1)),this}add(t,e,n){(n=n||{}).index=t.data("index")||0;let r=$(Mustache.render(t.data("template"),n));return $("input[type=checkbox]",r).each((t,e)=>{let n=$(e);n[0].hasAttribute("data-dynamic-table-checked")&&n.prop("checked",n.attr("data-dynamic-table-checked"))}),$("select",r).each((t,e)=>{let n=$(e);if(n[0].hasAttribute("data-dynamic-table-value")){let t=n.data("dynamic-table-value");$('option[value="'+t+'"]',n).prop("selected",!0)}n.css("width","100%").select2()}),e.append(r),t.data("index",n.index+1),t.trigger("dynamic-table:add",[r]),t.find(".js-admin-sortable").trigger("sortable:sort"),this.adminController.refreshUi(),this}remove(t,e){return e.remove(),t.trigger("dynamic-table:remove"),t.find(".js-admin-sortable").trigger("sortable:sort"),this.adminController.refreshUi(),this}};var c=class{constructor(t){return t.onRefreshUi(()=>{this.init()}),this}init(){return $("td.actions").each((t,e)=>{let n=$("> .btn, > .btn-group",e),r=[];n.each((t,e)=>{r.push(e.offsetTop)}),Math.max(...r)!==Math.min(...r)?(n.addClass("btn-block"),n.filter(".btn-group").find("> .btn").addClass("btn-block")):(n.removeClass("btn-block"),n.filter(".btn-group").find("> .btn").removeClass("btn-block"))}),this}};class u{constructor(t){return t.onRefreshUi(()=>{this.init()}),this}init(){return $(".js-admin-notes:not(.processed)").addClass("processed").each((t,e)=>{let n=$(e),r=$("<span>").addClass("admin-notes__counter"),i=n.data("model-name"),o=n.data("model-provider"),a=n.data("id"),s=n.data("modal-title")||"Notes",l=n.data("modal-width")||500,c=n.data("modal-max-height")||750;n.append(r).on("click",()=>{let t=$("<div>").dialog({modal:!0,title:s,width:l,maxHeight:c,position:{my:"center",at:"center",of:window}});return this.load(t,i,o,a),!1}),this.countNotes(i,o,a).done(t=>{this.setCounter(t)})}),this}load(t,e,n,r){t.html($("<p>").text("Loading...")),this.loadNotes(e,n,r).done(i=>{let o=$("<ul>").addClass("admin-notes"),a=$("<li>").addClass("admin-notes__empty").append($("<p>").text("No notes recorded for this item"));if(o.append(a),i.data.length){a.hide();for(let e=0,n=i.data.length;e<n;e++)o.append(this.renderMessageItem(t,i.data[e].id,i.data[e].message,i.data[e].user,i.data[e].date))}let s=$("<li>"),l=$("<textarea>"),c=$("<button>").addClass("btn btn-block btn-primary").text("Add Note").on("click",()=>{this.saveNote(e,n,r,l.val()).done(e=>{l.val(""),$(".admin-notes__empty",t).hide(),s.before(this.renderMessageItem(t,e.data.id,e.data.message,e.data.user,e.data.date)),this.setCounter(t.length).centerModal(t,!0)})});o.append(s.append(l).append(c)),t.html(o),this.centerModal(t,!0)})}centerModal(t,e){return t.dialog("option","position",{my:"center",at:"center",of:window}),e&&t.animate({scrollTop:t.find(".admin-notes").outerHeight()},200),this}countNotes(t,e,n){let r=new $.Deferred;return $.ajax({url:window.SITE_URL+"api/admin/note/count",data:{model_name:t,model_provider:e,item_id:n}}).done(t=>{r.resolve(t.data)}).fail(t=>{u.showError(t.responseText),r.reject(t.responseText)}),r.promise()}loadNotes(t,e,n){let r=new $.Deferred;return $.ajax({url:window.SITE_URL+"api/admin/note",data:{model_name:t,model_provider:e,item_id:n}}).done(t=>{r.resolve(t)}).fail(t=>{u.showError(t.responseText),r.reject(t.responseText)}),r.promise()}saveNote(t,e,n,r){let i=new $.Deferred;return $.ajax({url:window.SITE_URL+"api/admin/note",method:"POST",data:{model_name:t,model_provider:e,item_id:n,message:r}}).done(t=>{i.resolve(t)}).fail(t=>{u.showError(t.responseText),i.reject(t.responseText)}),i.promise()}deleteNote(t){let e=new $.Deferred;return $.ajax({url:window.SITE_URL+"api/admin/note/"+t,method:"DELETE"}).done(t=>{e.resolve(t)}).fail(t=>{u.showError(t.responseText),e.reject(t.responseText)}),e.promise()}renderMessageItem(t,e,n,r,i){let o=$("<li>").addClass("admin-notes__note"),a=$("<div>").addClass("admin-notes__note__message").html(n),s=$("<button>").addClass("admin-notes__note__delete").html("&times;"),l=$("<div>").addClass("admin-notes__note__meta"),c=$("<span>").addClass("admin-notes__note__meta__user").html(r.first_name+" "+r.last_name),u=$("<span>").addClass("admin-notes__note__meta__date").html(i);return s.on("click",()=>(this.deleteNote(e).done(()=>{o.remove(),this.centerModal(t,!1);let e=$(".admin-notes__note",t).length;this.setCounter(e),0===e&&$(".admin-notes__empty",t).show()}),!1)),o.append(a).append(s).append(l.append(c).append(u))}setCounter(t){return $(".admin-notes__counter").text(t||""),this}static showError(t){let e;try{e=JSON.parse(t)}catch(t){e={error:"An unknown error occurred"}}alert(e.error)}}var d=u,h=n(1),p=n.n(h);class f{constructor(t,e){return this.trigger("constructing"),this.index=0,this.$element=t,this.$target=$(".js-admin-repeater__target",this.$element),this.$add=$(".js-admin-repeater__add",this.$element),this.template=$(".js-admin-repeater__template",this.$element).html(),$(".js-admin-repeater__template",this.$element).remove(),this.bindEvents(),this.load(e||[]),this.trigger("constructed"),this}bindEvents(){this.trigger("binding"),this.$add.on("click",t=>(this.add(),!1)),this.$target.on("click",".js-admin-repeater__remove",t=>(this.remove($(t.currentTarget)),!1)),this.$element.on("js-admin-repeater:load",(t,e)=>{this.load(e)}).on("js-admin-repeater:clear",t=>{this.reset()}),this.trigger("bound")}add(t){(t=t||{}).index=this.index,this.trigger("adding",t);let e=$("<li>").addClass("js-admin-repeater__target__item"),n=this.template;n=p.a.render(n,t),e.html(n),this.$target.append(e),this.index++,this.trigger("added")}remove(t){let e=t.closest(".js-admin-repeater__target__item");this.trigger("removing",e),e.remove(),this.trigger("removed",e)}load(t){this.trigger("loading",t);for(let e in t)t.hasOwnProperty(e)&&this.add(t[e]);this.trigger("loaded",t)}reset(){this.trigger("resetting"),$(".js-admin-repeater__target__item",this.$target).remove(),this.index=0,this.trigger("reset")}trigger(t,e){let n={instance:this,data:e};console.log("js-admin-repeater:"+t,n)}}var m=class{constructor(t){return t.onRefreshUi(()=>{this.init()}),this}init(){return this.repeaters=[],$(".js-admin-repeater:not(.processed)").addClass("processed").each((t,e)=>{let n=$(e),r=new f(n,n.data("data"));n.data("js-admin-repeater-instance",r),this.repeaters.push(r)}),this}};class g{constructor(t,e){this.$input=$(t),this.$input.data("searcher")instanceof g||(this.api=this.coalesce(this.$input.data("api"),e.api),this.isMultiple=this.coalesce(this.$input.data("multiple"),e.isMultiple,!1),this.isClearable=this.coalesce(this.$input.data("clearable"),e.isClearable,!0),this.placeholder=this.coalesce(this.$input.data("placeholder"),e.placeholder,"Search for an item"),this.minLength=this.coalesce(this.$input.data("min-length"),e.minLength,2),this.getParam=this.coalesce(this.$input.data("get-param"),e.getParam,"search"),this.formatter=this.coalesce(e.formatter,null),this.api?this.$input.removeClass("js-searcher").select2({placeholder:this.placeholder,minimumInputLength:this.minLength,multiple:this.isMultiple,allowClear:this.isClearable,ajax:{url:window.SITE_URL+"api/"+this.api,dataType:"json",quietMillis:250,data:t=>{let e={};return e[this.getParam]=t,e},results:t=>({results:this.formatResults(t.data)}),cache:!0},initSelection:(t,e)=>{let n=$(t).val();""!==n&&this.isMultiple?$.ajax({url:window.SITE_URL+"api/"+this.api+"?ids="+n,dataType:"json"}).done(t=>{e(this.formatResults(t.data))}):""!==n&&$.ajax({url:window.SITE_URL+"api/"+this.api+"/"+n,dataType:"json"}).done(t=>{e(this.formatResult(t.data))})}}):console.warn("Element is configured as a Searcher but no api has been defined",this.$input))}formatResults(t){let e=[];for(let n=0;n<t.length;n++)e.push(this.formatResult(t[n]));return e}formatResult(t){return"function"==typeof this.formatter?this.formatter.call(this,t):{id:t.id,text:t.label}}coalesce(){var t=arguments.length;for(let e=0;e<t;e++)if(null!==arguments[e]&&void 0!==arguments[e])return arguments[e];return null}}var y=class{constructor(t){$(document).on("admin:js-searcher",(t,e,n)=>{n=n||{},$(e).each((t,e)=>{$(e).add("processed").data("searcher",new g(e,n))})}),t.onRefreshUi(()=>{$(document).trigger("admin:js-searcher",[".js-searcher:not(.processed)"])})}};var v=class{constructor(t){return t.onRefreshUi(()=>{this.init()}),this}init(){return $(".js-admin-sortable:not(.processed)").addClass("processed").each((function(){let t=$(this),e=t.data("handle")||null,n=t.data("axis")||"y",r=t.data("containment")||"parent";t.sortable({handle:e,axis:n,containment:r,forceHelperSize:!0,helper:function(t,e){let n=e.children(),r=e.clone();return r.children().each((function(t){$(this).width(n.eq(t).outerWidth())})),r},stop:function(){t.trigger("sortable:sort")}}).on("sortable:sort",()=>{t.find(".js-admin-sortable__order").each((function(t){$(this).val(t)}))})})),this}};class b{constructor(t){return this.slug=t,this.controls=[],this.panels=[],this.input=document.querySelectorAll('input[data-tabgroup="'+this.slug+'"]'),this.defaultTabSet=!1,this}addControl(t){this.controls.push(t)}addPanel(t){this.panels.push(t)}setDefaultActiveTab(){if(this.defaultTabSet)return this;this.defaultTabSet=!0;for(let t=0;t<this.controls.length;t++){let e=this.controls[t].getTarget();for(let t=0;t<this.panels.length;t++){let n=this.panels[t];if(n.targets(e)&&n.containsError())return this.goTo(e),this}}return this.input.length?(this.goTo(this.input[0].value),this):(this.controls.length>0&&this.goTo(this.controls[0].getTarget()),this)}setControlsWithErrors(){for(let t=0;t<this.controls.length;t++){let e=this.controls[t].getTarget();for(let n=0;n<this.panels.length;n++){let r=this.panels[n];r.targets(e)&&(r.containsError()?this.controls[t].setError():this.controls[t].setNoError())}}}goTo(t){let e;for(e=0;e<this.controls.length;e++)this.controls[e].targets(t)?this.controls[e].setActive():this.controls[e].setInactive();for(e=0;e<this.panels.length;e++)this.panels[e].targets(t)?this.panels[e].setActive():this.panels[e].setInactive();if(this.input.length)for(let e=0;e<this.input.length;e++)this.input[e].value=t}}class w{constructor(t,e){return this.group=t,this.element=e,this.link=this.element.querySelector("a"),this.target=this.link.dataset.tab,this.element.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.group.goTo(this.target)}),this}getTarget(){return this.target}targets(t){return this.target===t}isActive(){return this.element.classList.contains("active")}setActive(){return this.element.classList.add("active"),this}setInactive(){return this.element.classList.remove("active"),this}setError(){return this.link.classList.add("error"),this}setNoError(){return this.link.classList.remove("error"),this}}class _{constructor(t,e){return this.group=t,this.element=e,this}targets(t){return this.element.classList.contains(t)}isActive(){return this.element.classList.contains("active")}setActive(){this.element.classList.add("active")}setInactive(){this.element.classList.remove("active")}containsError(){let t=this.element.querySelectorAll("div.field.error, .system-alert.error, .alert.alert-danger, .error.show-in-tabs");return null!==t&&t.length>0}}var k=class{constructor(t){return this.groups={},t.onRefreshUi(()=>{this.init()}),this}init(){this.prepareDomElements().instantiateTabs();for(let t in this.groups)this.groups.hasOwnProperty(t)&&this.groups[t].setDefaultActiveTab().setControlsWithErrors();return this}prepareDomElements(){let t=["ul.tabs","section.tabs"];for(let e=0;e<t.length;e++){let n=0,r=document.querySelectorAll(t[e]+":not(.ready)");for(let t=0;t<r.length;t++)void 0===r[t].dataset.tabgroup&&r[t].setAttribute("data-tabgroup","tab-group-"+n++)}return this}instantiateTabs(){let t,e,n,r,i;for(t=document.querySelectorAll("ul.tabs:not(.ready)"),n=0;n<t.length;n++){for(r=t[n].dataset.tabgroup,this.groups.hasOwnProperty(r)||(this.groups[r]=new b(r)),e=t[n].querySelectorAll("li.tab"),i=0;i<e.length;i++)this.groups[r].addControl(new w(this.groups[r],e[i]));t[n].classList.add("ready")}for(t=document.querySelectorAll("section.tabs:not(.ready)"),n=0;n<t.length;n++){for(r=t[n].dataset.tabgroup,e=t[n].querySelectorAll("div.tab-page"),i=0;i<e.length;i++)this.groups[r].addPanel(new _(this.groups[r],e[i]));t[n].classList.add("ready")}return this}};let x;x=function(){return{instances:{},registerPlugin:function(t,e,n){void 0===this.instances[t]&&(this.instances[t]={}),this.instances[t][e]=n},trigger:function(t){document.dispatchEvent(new Event(t))},on:function(t,e){document.addEventListener(t,e)},refreshUi:function(){this.trigger("admin:refresh-ui")},onRefreshUi:function(t){this.on("admin:refresh-ui",t)}}},window.NAILS.ADMIN=new x,window.NAILS.ADMIN.registerPlugin("nails/module-admin","CopyToClipboard",new a(window.NAILS.ADMIN)),window.NAILS.ADMIN.registerPlugin("nails/module-admin","DisabledElements",new s),window.NAILS.ADMIN.registerPlugin("nails/module-admin","DynamicTable",new l(window.NAILS.ADMIN)),window.NAILS.ADMIN.registerPlugin("nails/module-admin","IndexButtons",new c(window.NAILS.ADMIN)),window.NAILS.ADMIN.registerPlugin("nails/module-admin","Notes",new d(window.NAILS.ADMIN)),window.NAILS.ADMIN.registerPlugin("nails/module-admin","Repeater",new m(window.NAILS.ADMIN)),window.NAILS.ADMIN.registerPlugin("nails/module-admin","Searcher",new y(window.NAILS.ADMIN)),window.NAILS.ADMIN.registerPlugin("nails/module-admin","Sortable",new v(window.NAILS.ADMIN)),window.NAILS.ADMIN.registerPlugin("nails/module-admin","Tabs",new k(window.NAILS.ADMIN)),window.NAILS.ADMIN.refreshUi()}]);