!function(){function e(n,t,a){function r(i,d){if(!t[i]){if(!n[i]){var s="function"==typeof require&&require;if(!d&&s)return s(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var l=t[i]={exports:{}};n[i][0].call(l.exports,function(e){var t=n[i][1][e];return r(t||e)},l,l.exports,e,n,t,a)}return t[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)r(a[i]);return r}return e}()({1:[function(e,n,t){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var r=e("./components/DynamicTable.js"),o=a(r),i=e("./components/Sortable.js"),d=a(i),s=e("./components/IndexButtons.js"),u=a(s),l=e("./components/Notes.js"),c=a(l),f=void 0;f=function(){new o["default"],new d["default"],new u["default"],new c["default"]}()},{"./components/DynamicTable.js":2,"./components/IndexButtons.js":3,"./components/Notes.js":4,"./components/Sortable.js":5}],2:[function(e,n,t){"use strict";function a(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),o=function(){function e(){var n=this;return a(this,e),$(".js-admin-dynamic-table").each(function(e,t){n.init($(t))}),this}return r(e,[{key:"init",value:function(e){var n=e.find(".js-admin-dynamic-table__template"),t=e.data("data")||[];e.data("template",n.html()),e.data("index",0),n.empty(),this.bindEvents(e,n);for(var a=0,r=t.length;a<r;a++)this.add(e,n,t[a]);return this}},{key:"bindEvents",value:function(e,n){var t=this;return $(".js-admin-dynamic-table__add",e).on("click",function(){return t.add(e,n),!1}),e.on("click",".js-admin-dynamic-table__remove",function(e){return t.remove($(e.currentTarget).closest("tr")),!1}),this}},{key:"add",value:function(e,n,t){return t=t||{},t.index=e.data("index")||0,n.append(Mustache.render(e.data("template"),t)),e.data("index",t.index+1),this}},{key:"remove",value:function(e){return e.remove(),this}}]),e}();t["default"]=o},{}],3:[function(e,n,t){"use strict";function a(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function o(){return a(this,o),$("td.actions").each(function(e,n){var t=$("> a",n);t.length>3&&t.addClass("btn-block")}),this};t["default"]=r},{}],4:[function(e,n,t){"use strict";function a(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),o=function(){function e(){var n=this;return a(this,e),$(".js-admin-notes").on("click",function(e){var t=$(e.currentTarget),a=$("<div>").dialog({modal:!0,title:t.data("modal-title")||"Notes",width:t.data("modal-width")||500,height:t.data("modal-height")||500});return n.load(a,t.data("model-name"),t.data("model-provider"),t.data("id")),!1}),this}return r(e,[{key:"load",value:function(n,t,a,r){n.html("<p>Loading...</p>"),$.ajax({url:window.SITE_URL+"api/admin/notes",data:{model_name:t,model_provider:a,id:r}}).done(function(o){if($ul=$("<ul>").addClass("admin-notes"),o.data.length)for(var i=0,d=o.data.length;i<d;i++)$ul.append(e.renderMessageItem(o.data[i].message,o.data[i].user,o.data[i].date));else $ul.append($("<li>").html("No notes recorded for this item"));var s=$("<li>"),u=$("<textarea>"),l=$("<button>").addClass("btn btn-block btn-primary").text("Add Item").on("click",function(){$.ajax({url:window.SITE_URL+"api/admin/notes",method:"POST",data:{model_name:t,model_provider:a,id:r,message:u.val()}}).done(function(n){u.val(""),s.before(e.renderMessageItem(n.data.message,n.data.user,n.data.date))}).error(function(n){e.showError(n.responseText)})});$ul.append(s.append(u).append(l)),n.html($ul)}).error(function(n){e.showError(n.responseText)})}}],[{key:"renderMessageItem",value:function(e,n,t){var a=$("<div>").addClass("admin-notes__message").html(e),r=$("<div>").addClass("admin-notes__meta"),o=$("<div>").addClass("admin-notes__user").html(n.first_name+" "+n.last_name),i=$("<div>").addClass("admin-notes__date").html(t);return $("<li>").append(a).append(r.append(o).append(i))}},{key:"showError",value:function(e){var n=void 0;try{n=JSON.parse(e)}catch(t){n={error:"An unknown error occurred"}}alert(n.error)}}]),e}();t["default"]=o},{}],5:[function(e,n,t){"use strict";function a(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function o(){return a(this,o),$(".js-admin-sortable").each(function(){var e=$(this),n=e.data("handle")||null,t=e.data("axis")||"y",a=e.data("containment")||"parent";e.sortable({handle:n,axis:t,containment:a,forceHelperSize:!0,helper:function(e,n){var t=n.children(),a=n.clone();return a.children().each(function(e){$(this).width(t.eq(e).outerWidth())}),a},stop:function(){e.find(".js-admin-sortable__order").each(function(e){$(this).val(e)})}})}),this};t["default"]=r},{}]},{},[1]);
//# sourceMappingURL=admin.min.js.map
