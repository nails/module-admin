/*! For license information please see admin.min.js.LICENSE.txt */
(()=>{var t={152:function(t){var e;e=function(){return function(){var t={134:function(t,e,i){"use strict";i.d(e,{default:function(){return v}});var n=i(279),r=i.n(n),s=i(370),o=i.n(s),a=i(817),l=i.n(a);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.resolveOptions(e),this.initSelection()}var e,i;return e=t,(i=[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"createFakeElement",value:function(){var t="rtl"===document.documentElement.getAttribute("dir");this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var e=window.pageYOffset||document.documentElement.scrollTop;return this.fakeElem.style.top="".concat(e,"px"),this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.fakeElem}},{key:"selectFake",value:function(){var t=this,e=this.createFakeElement();this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.container.appendChild(e),this.selectedText=l()(e),this.copyText(),this.removeFake()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=l()(this.target),this.copyText()}},{key:"copyText",value:function(){var t;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),document.activeElement.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==c(t)||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}])&&h(e.prototype,i),t}();function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){var i="data-clipboard-".concat(t);if(e.hasAttribute(i))return e.getAttribute(i)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(l,t);var e,i,n,r,s,a=(r=l,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(r);if(s){var i=g(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return m(this,t)});function l(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(i=a.call(this)).resolveOptions(e),i.listenClick(t),i}return e=l,n=[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,i=!!document.queryCommandSupported;return e.forEach((function(t){i=i&&!!document.queryCommandSupported(t)})),i}}],(i=[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===u(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=o()(t,"click",(function(t){return e.onClick(t)}))}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new d({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return y("action",t)}},{key:"defaultTarget",value:function(t){var e=y("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return y("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}])&&p(e.prototype,i),n&&p(e,n),l}(r())},828:function(t){if("undefined"!=typeof Element&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},438:function(t,e,i){var n=i(828);function r(t,e,i,n,r){var o=s.apply(this,arguments);return t.addEventListener(i,o,r),{destroy:function(){t.removeEventListener(i,o,r)}}}function s(t,e,i,r){return function(i){i.delegateTarget=n(i.target,e),i.delegateTarget&&r.call(t,i)}}t.exports=function(t,e,i,n,s){return"function"==typeof t.addEventListener?r.apply(null,arguments):"function"==typeof i?r.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return r(t,e,i,n,s)})))}},879:function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var i=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===i||"[object HTMLCollection]"===i)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},370:function(t,e,i){var n=i(879),r=i(438);t.exports=function(t,e,i){if(!t&&!e&&!i)throw new Error("Missing required arguments");if(!n.string(e))throw new TypeError("Second argument must be a String");if(!n.fn(i))throw new TypeError("Third argument must be a Function");if(n.node(t))return function(t,e,i){return t.addEventListener(e,i),{destroy:function(){t.removeEventListener(e,i)}}}(t,e,i);if(n.nodeList(t))return function(t,e,i){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,i)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,i)}))}}}(t,e,i);if(n.string(t))return function(t,e,i){return r(document.body,t,e,i)}(t,e,i);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},817:function(t){t.exports=function(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var i=t.hasAttribute("readonly");i||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),i||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var n=window.getSelection(),r=document.createRange();r.selectNodeContents(t),n.removeAllRanges(),n.addRange(r),e=n.toString()}return e}},279:function(t){function e(){}e.prototype={on:function(t,e,i){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:i}),this},once:function(t,e,i){var n=this;function r(){n.off(t,r),e.apply(i,arguments)}return r._=e,this.on(t,r,i)},emit:function(t){for(var e=[].slice.call(arguments,1),i=((this.e||(this.e={}))[t]||[]).slice(),n=0,r=i.length;n<r;n++)i[n].fn.apply(i[n].ctx,e);return this},off:function(t,e){var i=this.e||(this.e={}),n=i[t],r=[];if(n&&e)for(var s=0,o=n.length;s<o;s++)n[s].fn!==e&&n[s].fn._!==e&&r.push(n[s]);return r.length?i[t]=r:delete i[t],this}},t.exports=e,t.exports.TinyEmitter=e}},e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={exports:{}};return t[n](r,r.exports,i),r.exports}return i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i(134)}().default},t.exports=e()}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=i(152),e=i.n(t);class n{constructor(t,i){this.$body=$("body"),this.$el=$(i),this.$icon=$("<div>").text("Copied").css({position:"absolute",left:0,top:0,background:"#000000",color:"#ffffff",zIndex:1e6,padding:"0.25rem 0.5rem",borderRadius:"3px",border:"1px solid #ffffff",fontSize:"0.8rem"}),this.clipboardJs=new(e())(i),this.clipboardJs.on("success",(e=>{t.log("Item copied!"),this.showIcon(),e.clearSelection()})).on("error",(e=>{t.warn("Error",e),e.clearSelection()}))}showIcon(){this.$icon.remove(),this.$body.append(this.$icon),this.calcOffsetTop(),this.$icon.css({opacity:0,left:this.calcOffsetLeft(),top:this.calcOffsetTop()}).animate({opacity:1},100).delay(250).animate({opacity:0},250),setTimeout((()=>{this.$icon.remove()}),600)}calcOffsetLeft(){return this.$el.offset().left+this.$el.outerWidth()/2-this.$icon.outerWidth()/2}calcOffsetTop(){return this.$el.offset().top-this.$icon.outerHeight()-5}}class r{constructor(t,e,i){this.adminController=t,this.$trigger=$(e),this.$trigger.data("modalize")instanceof r||(this.target_id=this.coalesce(this.$trigger.data("target-id"),i.target_id),this.title=this.coalesce(this.$trigger.data("title"),i.title),this.width=this.coalesce(this.$trigger.data("width"),i.width),this.max_height=this.coalesce(this.$trigger.data("max-height"),i.max_height),this.target=document.getElementById(this.target_id),this.target?($(this.target).wrapInner("<div></div>").hide(),this.$trigger.on("click",(()=>(this.open(),!1)))):this.adminController.warn('"'+this.target_id+'" is not a valid ID'))}open(){this.adminController.log("Opening modal"),this.adminController.destroyUi(this.target);let t=$(this.target).find("> div").detach();this.adminController.log(t),this.$modal=$("<div>").html(t).dialog({modal:!0,dialogClass:"no-close no-padding",closeOnEscape:!1,draggable:!1,title:this.title,width:this.width,maxHeight:this.max_height,position:{my:"center",at:"center",of:window},open:()=>{this.adminController.refreshUi(this.$modal)},buttons:{OK:()=>{this.close()}}})}close(t){this.adminController.log("Closing modal"),this.adminController.getInstance("Wysiwyg").destroy(this.$modal);let e=this.$modal.find("> div").detach();$(this.target).append(e),this.$modal.dialog("close").remove(),this.$modal=null}coalesce(){var t=arguments.length;for(let e=0;e<t;e++)if(null!=arguments[e])return arguments[e];return null}}class s{constructor(t){return t.onRefreshUi(((t,e)=>{this.init()})),this}init(){return $(".js-admin-notes:not(.js-admin-notes--processed)").addClass("js-admin-notes--processed").each(((t,e)=>{let i=$(e),n=$("<span>").addClass("admin-notes__counter"),r=i.data("model-name"),s=i.data("model-provider"),o=i.data("id"),a=i.data("modal-title")||"Notes",l=i.data("modal-width")||500,c=i.data("modal-max-height")||750;i.append(n).on("click",(()=>{let t=$("<div>").dialog({modal:!0,title:a,width:l,maxHeight:c,position:{my:"center",at:"center",of:window}});return this.load(t,r,s,o),!1})),this.countNotes(r,s,o).done((t=>{this.setCounter(t)}))})),this}load(t,e,i,n){t.html($("<p>").text("Loading...")),this.loadNotes(e,i,n).done((r=>{let s=$("<ul>").addClass("admin-notes"),o=$("<li>").addClass("admin-notes__empty").append($("<p>").text("No notes recorded for this item"));if(s.append(o),r.data.length){o.hide();for(let e=0,i=r.data.length;e<i;e++)s.append(this.renderMessageItem(t,r.data[e].id,r.data[e].message,r.data[e].user,r.data[e].date))}let a=$("<li>"),l=$("<textarea>"),c=$("<button>").addClass("btn btn-block btn-primary").text("Add Note").on("click",(()=>{this.saveNote(e,i,n,l.val()).done((e=>{l.val(""),$(".admin-notes__empty",t).hide(),a.before(this.renderMessageItem(t,e.data.id,e.data.message,e.data.user,e.data.date)),this.setCounter(t.length).centerModal(t,!0)}))}));s.append(a.append(l).append(c)),t.html(s),this.centerModal(t,!0)}))}centerModal(t,e){return t.dialog("option","position",{my:"center",at:"center",of:window}),e&&t.animate({scrollTop:t.find(".admin-notes").outerHeight()},200),this}countNotes(t,e,i){let n=new $.Deferred;return $.ajax({url:window.SITE_URL+"api/admin/note/count",data:{model_name:t,model_provider:e,item_id:i}}).done((t=>{n.resolve(t.data)})).fail((t=>{s.showError(t.responseText),n.reject(t.responseText)})),n.promise()}loadNotes(t,e,i){let n=new $.Deferred;return $.ajax({url:window.SITE_URL+"api/admin/note",data:{model_name:t,model_provider:e,item_id:i}}).done((t=>{n.resolve(t)})).fail((t=>{s.showError(t.responseText),n.reject(t.responseText)})),n.promise()}saveNote(t,e,i,n){let r=new $.Deferred;return $.ajax({url:window.SITE_URL+"api/admin/note",method:"POST",data:{model_name:t,model_provider:e,item_id:i,message:n}}).done((t=>{r.resolve(t)})).fail((t=>{s.showError(t.responseText),r.reject(t.responseText)})),r.promise()}deleteNote(t){let e=new $.Deferred;return $.ajax({url:window.SITE_URL+"api/admin/note/"+t,method:"DELETE"}).done((t=>{e.resolve(t)})).fail((t=>{s.showError(t.responseText),e.reject(t.responseText)})),e.promise()}renderMessageItem(t,e,i,n,r){let s=$("<li>").addClass("admin-notes__note"),o=$("<div>").addClass("admin-notes__note__message").html(i),a=$("<button>").addClass("admin-notes__note__delete").html("&times;"),l=$("<div>").addClass("admin-notes__note__meta"),c=$("<span>").addClass("admin-notes__note__meta__user").html(n.first_name+" "+n.last_name),h=$("<span>").addClass("admin-notes__note__meta__date").html(r);return a.on("click",(()=>(this.deleteNote(e).done((()=>{s.remove(),this.centerModal(t,!1);let e=$(".admin-notes__note",t).length;this.setCounter(e),0===e&&$(".admin-notes__empty",t).show()})),!1))),s.append(o).append(a).append(l.append(c).append(h))}setCounter(t){return $(".admin-notes__counter").text(t||""),this}static showError(t){let e;try{e=JSON.parse(t)}catch(t){e={error:"An unknown error occurred"}}alert(e.error)}}const o=s;var a=Object.prototype.toString,l=Array.isArray||function(t){return"[object Array]"===a.call(t)};function c(t){return"function"==typeof t}function h(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function d(t,e){return null!=t&&"object"==typeof t&&e in t}var u=RegExp.prototype.test,p=/\S/;var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},m=/\s*/,g=/\s+/,y=/\s*=/,v=/\s*\}/,b=/#|\^|\/|>|\{|&|=|!/;function w(t){this.string=t,this.tail=t,this.pos=0}function C(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function k(){this.templateCache={_cache:{},set:function(t,e){this._cache[t]=e},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}w.prototype.eos=function(){return""===this.tail},w.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var i=e[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},w.prototype.scanUntil=function(t){var e,i=this.tail.search(t);switch(i){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=e.length,e},C.prototype.push=function(t){return new C(t,this)},C.prototype.lookup=function(t){var e,i,n,r=this.cache;if(r.hasOwnProperty(t))e=r[t];else{for(var s,o,a,l=this,h=!1;l;){if(t.indexOf(".")>0)for(s=l.view,o=t.split("."),a=0;null!=s&&a<o.length;)a===o.length-1&&(h=d(s,o[a])||(i=s,n=o[a],null!=i&&"object"!=typeof i&&i.hasOwnProperty&&i.hasOwnProperty(n))),s=s[o[a++]];else s=l.view[t],h=d(l.view,t);if(h){e=s;break}l=l.parent}r[t]=e}return c(e)&&(e=e.call(this.view)),e},k.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},k.prototype.parse=function(t,e){var i=this.templateCache,n=t+":"+(e||x.tags).join(":"),r=void 0!==i,s=r?i.get(n):void 0;return null==s&&(s=function(t,e){if(!t)return[];var i,n,r,s,o=!1,a=[],c=[],d=[],f=!1,$=!1,C="",k=0;function S(){if(f&&!$)for(;d.length;)delete c[d.pop()];else d=[];f=!1,$=!1}function _(t){if("string"==typeof t&&(t=t.split(g,2)),!l(t)||2!==t.length)throw new Error("Invalid tags: "+t);i=new RegExp(h(t[0])+"\\s*"),n=new RegExp("\\s*"+h(t[1])),r=new RegExp("\\s*"+h("}"+t[1]))}_(e||x.tags);for(var T,A,I,E,j,N,L=new w(t);!L.eos();){if(T=L.pos,I=L.scanUntil(i))for(var U=0,R=I.length;U<R;++U)s=E=I.charAt(U),function(t,e){return u.call(t,e)}(p,s)?($=!0,o=!0,C+=" "):(d.push(c.length),C+=E),c.push(["text",E,T,T+1]),T+=1,"\n"===E&&(S(),C="",k=0,o=!1);if(!L.scan(i))break;if(f=!0,A=L.scan(b)||"name",L.scan(m),"="===A?(I=L.scanUntil(y),L.scan(y),L.scanUntil(n)):"{"===A?(I=L.scanUntil(r),L.scan(v),L.scanUntil(n),A="&"):I=L.scanUntil(n),!L.scan(n))throw new Error("Unclosed tag at "+L.pos);if(j=">"==A?[A,I,T,L.pos,C,k,o]:[A,I,T,L.pos],k++,c.push(j),"#"===A||"^"===A)a.push(j);else if("/"===A){if(!(N=a.pop()))throw new Error('Unopened section "'+I+'" at '+T);if(N[1]!==I)throw new Error('Unclosed section "'+N[1]+'" at '+T)}else"name"===A||"{"===A||"&"===A?$=!0:"="===A&&_(I)}if(S(),N=a.pop())throw new Error('Unclosed section "'+N[1]+'" at '+L.pos);return function(t){for(var e,i=[],n=i,r=[],s=0,o=t.length;s<o;++s)switch((e=t[s])[0]){case"#":case"^":n.push(e),r.push(e),n=e[4]=[];break;case"/":r.pop()[5]=e[2],n=r.length>0?r[r.length-1][4]:i;break;default:n.push(e)}return i}(function(t){for(var e,i,n=[],r=0,s=t.length;r<s;++r)(e=t[r])&&("text"===e[0]&&i&&"text"===i[0]?(i[1]+=e[1],i[3]=e[3]):(n.push(e),i=e));return n}(c))}(t,e),r&&i.set(n,s)),s},k.prototype.render=function(t,e,i,n){var r=this.getConfigTags(n),s=this.parse(t,r),o=e instanceof C?e:new C(e,void 0);return this.renderTokens(s,o,i,t,n)},k.prototype.renderTokens=function(t,e,i,n,r){for(var s,o,a,l="",c=0,h=t.length;c<h;++c)a=void 0,"#"===(o=(s=t[c])[0])?a=this.renderSection(s,e,i,n,r):"^"===o?a=this.renderInverted(s,e,i,n,r):">"===o?a=this.renderPartial(s,e,i,r):"&"===o?a=this.unescapedValue(s,e):"name"===o?a=this.escapedValue(s,e,r):"text"===o&&(a=this.rawValue(s)),void 0!==a&&(l+=a);return l},k.prototype.renderSection=function(t,e,i,n,r){var s=this,o="",a=e.lookup(t[1]);if(a){if(l(a))for(var h=0,d=a.length;h<d;++h)o+=this.renderTokens(t[4],e.push(a[h]),i,n,r);else if("object"==typeof a||"string"==typeof a||"number"==typeof a)o+=this.renderTokens(t[4],e.push(a),i,n,r);else if(c(a)){if("string"!=typeof n)throw new Error("Cannot use higher-order sections without the original template");null!=(a=a.call(e.view,n.slice(t[3],t[5]),(function(t){return s.render(t,e,i,r)})))&&(o+=a)}else o+=this.renderTokens(t[4],e,i,n,r);return o}},k.prototype.renderInverted=function(t,e,i,n,r){var s=e.lookup(t[1]);if(!s||l(s)&&0===s.length)return this.renderTokens(t[4],e,i,n,r)},k.prototype.indentPartial=function(t,e,i){for(var n=e.replace(/[^ \t]/g,""),r=t.split("\n"),s=0;s<r.length;s++)r[s].length&&(s>0||!i)&&(r[s]=n+r[s]);return r.join("\n")},k.prototype.renderPartial=function(t,e,i,n){if(i){var r=this.getConfigTags(n),s=c(i)?i(t[1]):i[t[1]];if(null!=s){var o=t[6],a=t[5],l=t[4],h=s;0==a&&l&&(h=this.indentPartial(s,l,o));var d=this.parse(h,r);return this.renderTokens(d,e,i,h,n)}}},k.prototype.unescapedValue=function(t,e){var i=e.lookup(t[1]);if(null!=i)return i},k.prototype.escapedValue=function(t,e,i){var n=this.getConfigEscape(i)||x.escape,r=e.lookup(t[1]);if(null!=r)return"number"==typeof r&&n===x.escape?String(r):n(r)},k.prototype.rawValue=function(t){return t[1]},k.prototype.getConfigTags=function(t){return l(t)?t:t&&"object"==typeof t?t.tags:void 0},k.prototype.getConfigEscape=function(t){return t&&"object"==typeof t&&!l(t)?t.escape:void 0};var x={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){S.templateCache=t},get templateCache(){return S.templateCache}},S=new k;x.clearCache=function(){return S.clearCache()},x.parse=function(t,e){return S.parse(t,e)},x.render=function(t,e,i,n){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(l(r=t)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)');var r;return S.render(t,e,i,n)},x.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,(function(t){return f[t]}))},x.Scanner=w,x.Context=C,x.Writer=k;const _=x;class T{constructor(t,e,i){return this.adminController=t,this.$element=e,this.index=0,this.trigger("constructing"),this.$target=$(".js-admin-repeater__target",this.$element),this.$add=$(".js-admin-repeater__add",this.$element),this.template=$(".js-admin-repeater__template",this.$element).html(),$(".js-admin-repeater__template",this.$element).remove(),this.bindEvents(),this.load(i||[]),this.trigger("constructed"),this}bindEvents(){this.trigger("binding"),this.$add.on("click",(t=>(this.add(),!1))),this.$target.on("click",".js-admin-repeater__remove",(t=>(this.remove($(t.currentTarget)),!1))),this.$element.on("js-admin-repeater:load",((t,e)=>{this.load(e)})).on("js-admin-repeater:clear",(t=>{this.reset()})),this.trigger("bound")}add(t){(t=t||{}).index=this.index,this.trigger("adding",t);let e=$("<li>").addClass("js-admin-repeater__target__item"),i=this.template;i=_.render(i,t),e.html(i),$("input[type=checkbox]",e).each(((t,e)=>{let i=$(e);i[0].hasAttribute("data-repeater-checked")&&i.prop("checked",i.attr("data-repeater-checked"))})),$("select",e).each(((t,e)=>{let i=$(e);if(i[0].hasAttribute("data-repeater-value")){let t=i.data("repeater-value");$('option[value="'+t+'"]',i).prop("selected",!0)}i.css("width","100%").select2()})),this.$target.append(e),this.index++,this.$element.find(".js-admin-sortable").trigger("sortable:sort"),this.noRefresh||this.adminController.refreshUi(e),this.trigger("added")}remove(t){let e=t.closest(".js-admin-repeater__target__item");this.trigger("removing",e),e.remove(),this.$element.find(".js-admin-sortable").trigger("sortable:sort"),this.trigger("removed",e)}load(t){this.trigger("loading",t),this.noRefresh=!0;for(let e in t)t.hasOwnProperty(e)&&this.add(t[e]);this.noRefresh=!1,this.adminController.refreshUi(this.$element),this.trigger("loaded",t)}reset(){this.trigger("resetting"),$(".js-admin-repeater__target__item",this.$target).remove(),this.index=0,this.trigger("reset")}trigger(t,e){let i={instance:this,data:e};this.adminController.log("Triggering Event: "+t,i)}}class A{constructor(t,e,i){this.adminController=t,this.group=e,this.$control=$(i),this.elements=[],this.$control.on("change",(()=>{this.toggle(this.getControlValue())}))}findNewElements(t){return $(`[data-revealer="${this.group}"]:not(.revealer--processed)`,t).filter(":not(input[type=checkbox], select)").addClass("revealer--processed").each(((t,e)=>{this.elements.push(new I(e))})),this.$control.trigger("change"),this}getControlValue(){let t;return t=this.$control.is("[type=checkbox]")?this.$control.is(":checked"):this.$control.val(),t}toggle(t){this.adminController.log("Toggling elements for value",t);for(let e=0;e<this.elements.length;e++)this.elements[e].isShown(t)?this.elements[e].show():this.elements[e].hide();this.adminController.refreshUi()}destroy(){this.$control.removeClass("revealer--processed");for(let t=0;t<this.elements.length;t++)this.elements[t].destroy()}}class I{constructor(t){this.$element=$(t),this.delimiter=this.$element.data("reveal-delimiter")||",",this.values=t.hasAttribute("data-reveal-on")?t.getAttribute("data-reveal-on"):null,null!==this.values&&(this.values=this.values.split(this.delimiter)),this.bangValues=t.hasAttribute("data-reveal-not-on")?t.getAttribute("data-reveal-not-on"):null,null!==this.bangValues&&(this.bangValues=this.bangValues.split(this.delimiter))}isShown(t){let e=this.testValue(this.values,t,!1),i=this.testValue(this.bangValues,t,!0);return e||i}testValue(t,e,i){if(null!==t){if(e.length&&!t.length)return!0;for(let n=0;n<t.length;n++){let r=t[n];if("boolean"==typeof e){if(!i&&e&&[!0,1,"true","1"].indexOf(r)>-1||!i&&!e&&[!1,0,"false","0"].indexOf(r)>-1||i&&e&&-1===[!0,1,"true","1"].indexOf(r)||i&&!e&&-1===[!1,0,"false","0"].indexOf(r))return!0}else{if(!i&&r==e)return!0;if(i&&r!=e)return!0}}}return!1}show(){return this.$element.show(),this}hide(){return this.$element.hide(),this}destroy(){this.$element.removeClass("revealer--processed"),this.show()}}class E{constructor(t,e,i){this.$input=$(e),this.adminController=t,this.$input.data("searcher")instanceof E||(this.api=this.coalesce(this.$input.data("api"),i.api),this.isMultiple=this.coalesce(this.$input.data("multiple"),i.isMultiple,!1),this.isClearable=this.coalesce(this.$input.data("clearable"),i.isClearable,!0),this.placeholder=this.coalesce(this.$input.data("placeholder"),i.placeholder,"Search for an item"),this.minLength=this.coalesce(this.$input.data("min-length"),i.minLength,2),this.getParam=this.coalesce(this.$input.data("get-param"),i.getParam,"search"),this.formatter=this.coalesce(i.formatter,null),this.propId=this.coalesce(this.$input.data("prop-id"),i.propId,"id"),this.propLabel=this.coalesce(this.$input.data("prop-label"),i.propLabel,"label"),this.api?this.$input.removeClass("js-searcher").select2({placeholder:this.placeholder,minimumInputLength:this.minLength,multiple:this.isMultiple,allowClear:this.isClearable,ajax:{url:window.SITE_URL+"api/"+this.api,dataType:"json",quietMillis:250,data:t=>{let e={};return e[this.getParam]=t,e},results:t=>({results:this.formatResults(t.data)}),cache:!0},initSelection:(t,e)=>{let i=$(t).val();""!==i&&this.isMultiple?$.ajax({url:window.SITE_URL+"api/"+this.api+"?ids="+i,dataType:"json"}).done((t=>{e(this.formatResults(t.data))})):""!==i&&$.ajax({url:window.SITE_URL+"api/"+this.api+"/"+i,dataType:"json"}).done((t=>{e(this.formatResult(t.data))}))}}):this.adminController.warn("Element is configured as a Searcher but no api has been defined",this.$input))}formatResults(t){let e=[];for(let i=0;i<t.length;i++)e.push(this.formatResult(t[i]));return e}formatResult(t){return"function"==typeof this.formatter?this.formatter.call(this,t):{id:t[this.propId],text:t[this.propLabel]}}coalesce(){var t=arguments.length;for(let e=0;e<t;e++)if(null!=arguments[e])return arguments[e];return null}}class j{constructor(t,e){this.adminController=t,this.$input=$(e),this.isMultiple=this.$input.data("multiple"),this.isClearable=this.$input.data("clearable"),this.placeholder=this.$input.data("placeholder")||"Search for an item",this.$input.select2({placeholder:this.placeholder,multiple:this.isMultiple,allowClear:this.isClearable})}}class N{constructor(t,e){return this.slug=t,this.adminController=e,this.controls=[],this.panels=[],this.input=document.querySelectorAll('input[data-tabgroup="'+this.slug+'"]'),this.defaultTabSet=!1,this}addControl(t){this.controls.push(t)}addPanel(t){this.panels.push(t)}setDefaultActiveTab(){if(this.defaultTabSet)return this;this.defaultTabSet=!0;for(let t=0;t<this.controls.length;t++){let e=this.controls[t].getTarget();for(let t=0;t<this.panels.length;t++){let i=this.panels[t];if(i.targets(e)&&i.containsError())return this.goTo(e),this}}return this.input.length&&this.input[0].value.length?(this.goTo(this.input[0].value),this):(this.controls.length>0&&this.goTo(this.controls[0].getTarget()),this)}setControlsWithErrors(){for(let t=0;t<this.controls.length;t++){let e=this.controls[t].getTarget();for(let i=0;i<this.panels.length;i++){let n=this.panels[i];n.targets(e)&&(n.containsError()?this.controls[t].setError():this.controls[t].setNoError())}}}goTo(t){let e;for(e=0;e<this.controls.length;e++)this.controls[e].targets(t)?this.controls[e].setActive():this.controls[e].setInactive();for(e=0;e<this.panels.length;e++)this.panels[e].targets(t)?this.panels[e].setActive():this.panels[e].setInactive();if(this.input.length)for(let e=0;e<this.input.length;e++)this.input[e].value=t;this.adminController.refreshUi()}}class L{constructor(t,e){return this.group=t,this.element=e,this.link=this.element.querySelector("a"),this.target=this.link.dataset.tab,this.element.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),this.group.goTo(this.target)})),this}getTarget(){return this.target}targets(t){return this.target===t}isActive(){return this.element.classList.contains("active")}setActive(){return this.element.classList.add("active"),this}setInactive(){return this.element.classList.remove("active"),this}setError(){return this.link.classList.add("error"),this}setNoError(){return this.link.classList.remove("error"),this}}class U{constructor(t,e){return this.group=t,this.element=e,this}targets(t){return this.element.classList.contains(t)}isActive(){return this.element.classList.contains("active")}setActive(){this.element.classList.add("active")}setInactive(){this.element.classList.remove("active")}containsError(){let t=this.element.querySelectorAll("div.field.error, .system-alert.error, .alert.alert-danger, .error.show-in-tabs");return null!==t&&t.length>0}}class R{constructor(t,e){this.adminController=t,this.$timecode=e,this.$seconds=e.next(".js-timecode-input"),this.$error=this.$seconds.next(".js-timecode-error"),this.$timecode.on("change",(()=>{this.hideError()})).on("blur",(t=>{try{this.setSeconds(this.convertTimecodeToSeconds(t.currentTarget.value))}catch(t){this.showError(t.message)}})),this.$seconds.on("change",(()=>{this.hideError()})).on("blur",(t=>{this.setTimeCode(this.convertSecondsToTimecode(t.currentTarget.value))})),this.$timecode.val(this.convertSecondsToTimecode(this.$seconds.val()))}setTimeCode(t){this.$timecode.val(t||"00:00:00")}setSeconds(t){this.$seconds.val(t||0)}showError(t){this.adminController.log(t),this.$error.text(t).addClass("alert alert-danger")}hideError(){this.$error.text("").removeClass("alert alert-danger")}convertTimecodeToSeconds(t){if(!/^\d{2,}:[0-5]\d:[0-5]\d$/.test(t))throw Error("Invalid timecode (expected format: hh:mm:ss)");let e=t.split(":");return 60*parseInt(e[0])*60+60*parseInt(e[1])+parseInt(e[2])}convertSecondsToTimecode(t){let e=0,i=0,n=0;if(e=t%60,i=(t-e)/60,i>59){let t=i%60;n=Math.floor(i/60),i=t}return[this.pad(n),this.pad(i),this.pad(e)].join(":")}pad(t){return t<10?"0"+t:t.toString()}}class M{constructor(t){this.container=t,this.checkbox=this.container.next("input[type=checkbox]"),this.is_readonly=this.checkbox.hasClass("readonly"),this.width=this.checkbox.data("toggle-width")||"100px",this.height=this.checkbox.data("toggle-height")||"30px",this.text_on=this.checkbox.data("text-on")||"ON",this.text_off=this.checkbox.data("text-off")||"OFF",this.checkbox.hide(),this.container.addClass("toggled").css({width:this.width,height:this.height,"text-align":"center"}).toggles({checkbox:this.checkbox,click:!this.is_readonly,drag:!this.is_readonly,clicker:this.checkbox,on:this.checkbox.is(":checked"),text:{on:this.text_on,off:this.text_off}}).on("toggle",((t,e)=>{this.checkbox.trigger("toggle",[e]).trigger("change")}))}destroy(){this.container.empty().removeClass("toggled").removeAttr("style"),this.checkbox.show()}}class D{constructor(t,e,i){this.adminController=t,this.container=e,this.config=i,this.adminController.log("Constructing",this.container),this.container.addClass("wysiwyged").ckeditor({customConfig:this.container.hasClass("wysiwyg-basic")?this.config.basic:this.config.default})}destroy(){this.adminController.log("Destroying",this.container),this.container.removeClass("wysiwyged").ckeditor((function(){this.destroy()})).data("instance",null)}}let P,O;O=function(t,e,i){return{vendor:t,slug:e,getInstance:function(t,e){return window.NAILS.ADMIN.getInstance(t,e)},onRefreshUi:function(t){return window.NAILS.ADMIN.onRefreshUi(t),this},refreshUi:function(t){return this.log("🙋‍♀️ UI refresh requested",t||document),window.NAILS.ADMIN.refreshUi(t),this},destroyUi:function(t){return window.NAILS.ADMIN.destroyUi(t),this},onDestroyUi:function(t){return window.NAILS.ADMIN.onDestroyUi(t),this},log:function(){return"function"==typeof console.log&&console.log(`%c[${this.vendor}: ${this.slug}]`,"color: goldenrod",...arguments),this},warn:function(){return"function"==typeof console.warn&&console.warn(`%c[${this.vendor}: ${this.slug}]`,"color: goldenrod",...arguments),this},error:function(){return"function"==typeof console.error&&console.error(`%c[${this.vendor}: ${this.slug}]`,"color: goldenrod",...arguments),this}}},P=function(){return{namespace:"nails/module-admin",instances:{},getInstance:function(t,e){return e=e||window.NAILS.ADMIN.namespace,window.NAILS.ADMIN.instances[e][t]},registerPlugin:function(t,e,i){return void 0===this.instances[t]&&(this.instances[t]={}),this.instances[t][e]="function"==typeof i?i(new O(t,e)):i,this},trigger:function(t,e){return document.dispatchEvent(new CustomEvent(t,{detail:e})),this},on:function(t,e){return document.addEventListener(t,e),this},refreshUiSet:new Set,refreshUi:function(t){return t=t||document,this.uiIsRefreshing&&this.refreshUiSet.add(t),this.refreshUiSet.add(t),clearTimeout(this.refreshTimeout),this.refreshTimeout=setTimeout((()=>{this.refreshUiSet.size>0&&(this.uiIsRefreshing=!0,this.log(`🔄 Refreshing UI (${this.refreshUiSet.size} items)`),this.refreshUiSet.forEach((t=>{this.log("👷‍♂️ Refreshing:",t),this.trigger("admin:refresh-ui",{domElement:t}),this.refreshUiSet.delete(t),this.log("🙌🏻 Refreshed:",t)})),this.log("✅ Refreshed UI"),this.uiIsRefreshing=!1)}),10),this},onRefreshUi:function(t){return this.on("admin:refresh-ui",(function(e){t(e,e.detail?e.detail.domElement:null)})),this},destroyUi:function(t){return this.log("Destroying UI",t||document),this.trigger("admin:destroy-ui",{domElement:t||document}),this},onDestroyUi:function(t){return this.on("admin:destroy-ui",(function(e){t(e,e.detail?e.detail.domElement:null)})),this},log:function(){"function"==typeof console.log&&console.log(`%c[${this.namespace}]`,"color: goldenrod",...arguments)},warn:function(t,e){"function"==typeof console.warn&&console.warn(`%c[${this.namespace}]`,"color: goldenrod",...arguments)}}},window.NAILS.ADMIN=new P,window.NAILS.ADMIN.registerPlugin(window.NAILS.ADMIN.namespace,"Alerts",(function(t){return new class{constructor(t){return t.onRefreshUi(((t,e)=>{this.init()})),this}init(){return $(".alert__close:not(.alert__close--initiated)").addClass("alert__close--initiated").on("click",(function(){$(this).closest(".alert").remove()})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Confirm",(function(t){return new class{constructor(t){return t.onRefreshUi(((t,e)=>{this.init(e)})),this}init(t){return $("a.confirm:not(.confirm--processed)",t).addClass("confirm--processed").on("click",(t=>{let e=$(t.currentTarget),i=e.data("body")||"Please confirm you'd like to continue with this action.",n=e.data("title")||"Are you sure?";return i.replace(/\\n/g,"\n"),!i.length||($("<div>").html(i).dialog({title:n,resizable:!1,draggable:!1,modal:!0,dialogClass:"no-close",buttons:{OK:function(){window.location.href=e.attr("href")},Cancel:function(){$(this).dialog("close")}}}),!1)})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"CopyToClipboard",(function(t){return new class{constructor(t){$(document).on("admin:js-copy-to-clipboard",((e,i)=>{t.log("Initiating new copy buttons"),$(i).addClass("js-copy-to-clipboard--initiated").each(((e,i)=>{$(i).data("clipboardjs")||$(i).data("clipboardjs",new n(t,i))}))})),t.onRefreshUi(((t,e)=>{$(document).trigger("admin:js-copy-to-clipboard",[".js-copy-to-clipboard"])}))}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"DateTime",(function(t){return new class{constructor(t){return this.adminController=t,this.processing=!1,this.checkAgain=[],this.adminController.onRefreshUi(((t,e)=>{this.init(e)})),this}init(t){this.adminController.log("Initiating new date/time inputs");let e=$(["input.date:not(.datetime--processed)","input.datetime:not(.datetime--processed)","input.time:not(.datetime--processed)"].join(","),t).addClass("datetime--processed");this.adminController.log(`Found ${e.length} unprocessed items`),e.each(((t,e)=>{e.classList.contains("date")?this.initDate(e):e.classList.contains("datetime")?this.initDateTime(e):e.classList.contains("time")&&this.initTime(e)}))}initDate(t){let e=$(t),i=e.data("datepicker-dateformat")||"yy-mm-dd",n=e.data("datepicker-yearrange")||"c-100:c+10";e.datepicker({dateFormat:i,changeMonth:!0,changeYear:!0,yearRange:n})}initDateTime(t){let e=$(t),i=e.data("datepicker-dateformat")||"yy-mm-dd",n=e.data("datepicker-timeformat")||"HH:mm:ss",r=e.data("datepicker-yearrange")||"c-100:c+10";e.datetimepicker({dateFormat:i,timeFormat:n,changeMonth:!0,changeYear:!0,yearRange:r})}initTime(t){let e=$(t),i=e.data("datepicker-timeformat")||"HH:mm";e.datetimepicker({timeOnly:!0,timeFormat:i})}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"DisabledElements",(function(t){return new class{constructor(){return $(document).on("click",".btn-disabled",(()=>!1)),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"DynamicTable",(function(t){return new class{constructor(t){return this.adminController=t,this.adminController.onRefreshUi(((t,e)=>{$(".js-admin-dynamic-table:not(.ready)").addClass("ready").each(((t,e)=>{this.init($(e))}))})),this}init(t){t.trigger("dynamic-table:starting");let e=t.find(".js-admin-dynamic-table__template"),i=t.find(".js-admin-dynamic-table__body"),n=t.data("data")||[];t.data("template",e.html()),t.data("index",0),i.empty(),this.bindEvents(t,i);for(let e=0,r=n.length;e<r;e++)this.add(t,i,n[e],!1);return t.trigger("dynamic-table:ready"),this}bindEvents(t,e){return $(".js-admin-dynamic-table__add",t).on("click",(()=>(this.add(t,e,{},!0),!1))),t.on("click",".js-admin-dynamic-table__remove",(e=>(this.remove(t,$(e.currentTarget).closest("tr")),!1))),this}add(t,e,i,n){(i=i||{}).index=t.data("index")||0;let r=$(Mustache.render(t.data("template").replace("<\\/script>","<\/script>"),i));return $("input[type=checkbox]",r).each(((t,e)=>{let i=$(e);i[0].hasAttribute("data-dynamic-table-checked")&&i.prop("checked",i.attr("data-dynamic-table-checked"))})),$("select",r).each(((t,e)=>{let i=$(e);if(i[0].hasAttribute("data-dynamic-table-value")){let t=i.data("dynamic-table-value");$('option[value="'+t+'"]',i).prop("selected",!0)}i.css("width","100%").select2()})),e.append(r),t.data("index",i.index+1),t.trigger("dynamic-table:add",[r]),t.find(".js-admin-sortable").trigger("sortable:sort"),n&&this.adminController.refreshUi(r),this}remove(t,e){return e.remove(),t.trigger("dynamic-table:remove"),t.find(".js-admin-sortable").trigger("sortable:sort"),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Fancybox",(function(t){return new class{constructor(t){return this.init(),this}init(t){return $(document).on("click",".fancybox",(function(t){t.preventDefault(),t.stopPropagation();let e=$(this).attr("href"),i="iframe";"#"!==e.substr(0,1)?(/^.+.(jpg|png|gif)(\?.*)?$/.test(e)&&(i=null),e+=/\?/.test(e)?"&":"?",e+="isModal=true"):i=null;let n=$(this).data("height"),r=$(this).data("width");return $.fancybox.open({href:e,height:n,width:r,type:i,helpers:{overlay:{locked:!1}},beforeLoad:function(){$("body").addClass("noScroll modal-open")},afterClose:function(){$("body").removeClass("noScroll modal-open")}}),!1})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"IndexButtons",(function(t){return new class{constructor(t){return t.onRefreshUi(((t,e)=>{this.init(e)})),this}init(t){return $("td.actions",t).each(((t,e)=>{let i=$("> .btn, > .btn-group",e),n=[];i.each(((t,e)=>{n.push(e.offsetTop)})),Math.max(...n)!==Math.min(...n)?(i.addClass("btn-block"),i.filter(".btn-group").find("> .btn").addClass("btn-block")):(i.removeClass("btn-block"),i.filter(".btn-group").find("> .btn").removeClass("btn-block"))})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"InputHelper",(function(t){return new class{constructor(t){return this.helpers=[],t.onRefreshUi(((t,e)=>{this.findNewHelpers(e),this.positionHelpers()})),this}findNewHelpers(t){return $("input[data-helper]:not(.input-helper--processed",t).addClass("input-helper--processed").each(((t,e)=>{let i=$(e),n=i.data("helper"),r=$("<div>").html(n).insertAfter(i);this.helpers.push({helper:r,input:i})})),this}positionHelpers(){for(let t=0;t<this.helpers.length;t++){let e=this.helpers[t];if(e.input.is(":visible")){let t=`${e.input.outerHeight()}px`;e.helper.css({position:"absolute",background:"rgba(0, 0, 0, 0.07)",border:"1px solid transparent","border-right":"1px solid rgba(0, 0, 0, 0.1)",transform:"translateY(-100%)",height:t,lineHeight:t,padding:"0 0.5rem"}),e.input.css({paddingLeft:e.helper.outerWidth()+7})}}}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Modalize",(function(t){return new class{constructor(t){return $(document).on("admin:js-admin-modalize",((t,e,i,n)=>{this.adminController.log("Initiating new modalize buttons"),this.init(e,i,n)})),this.adminController=t,this.adminController.onRefreshUi(((t,e)=>{$(document).trigger("admin:js-admin-modalize",[".js-admin-modalize:not(.modalized)",{},e])})),this}init(t,e,i){return e=e||{},$(t,i).each(((t,i)=>{$(i).add("modalized").data("modalize",new r(this.adminController,i,e))})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Notes",(function(t){return new o(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Repeater",(function(t){return new class{constructor(t){return this.adminController=t,this.adminController.onRefreshUi(((t,e)=>{this.init(e)})),this}init(t){return $(".js-admin-repeater:not(.js-admin-repeater--processed)",t).addClass("js-admin-repeater--processed").each(((t,e)=>{let i=$(e),n=new T(this.adminController,i,i.data("data"));i.data("js-admin-repeater-instance",n)})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Revealer",(function(t){return new class{constructor(t){return this.groups={},this.adminController=t,this.adminController.onRefreshUi(((t,e)=>{this.init(e)})).onDestroyUi(((t,e)=>{this.destroy(e)})),this}init(t){let e=[".revealer--processed","[data-reveal-on]","[data-reveal-not-on]"],i="[data-revealer]";for(let t=0;t<e.length;t++)i+=`:not(${e[t]})`;return $(i,t).filter(":input").filter("input[type=checkbox], select, input[data-api]").addClass("revealer--processed").each(((e,i)=>{let n=$(i).data("revealer");void 0===this.groups[n]?(this.groups[n]=new A(this.adminController,n,i),this.groups[n].findNewElements(t)):this.adminController.warn(`Duplicate group "${n}"`)})),this}destroy(t){for(let e in this.groups)this.groups.hasOwnProperty(e)&&(null===t||$.contains(t,this.groups[e].$control))&&(this.groups[e].destroy(),delete this.groups[e])}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"ScrollToFirstError",(function(t){return new class{constructor(t){let e,i,n;return e=$("div.field.error:visible"),e.length?n=$(e.get(0)):(i=$("div.system-alert.error:visible"),n=$(i.get(0))),n.length&&setTimeout((()=>{$.scrollTo(n,"fast",{axis:"y",offset:{top:-60}})}),750),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Searcher",(function(t){return new class{constructor(t){return this.adminController=t,$(document).on("admin:js-searcher",((t,e,i,n)=>{this.adminController.log("Initiating new searchers"),this.init(e,i,n)})),this.adminController.onRefreshUi(((t,e)=>{$(document).trigger("admin:js-searcher",[".js-searcher:not(.js-searcher--processed)",{},e])})),this}init(t,e,i){return e=e||{},$(t,i).each(((t,i)=>{$(i).add("js-searcher--processed").data("searcher",new E(this.adminController,i,e))})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Select",(function(t){return new class{constructor(t){return t.onRefreshUi(((t,e)=>{this.init(e)})),this}init(t){return $("select.select2:not(.select2-offscreen):not(.select2--processed)",t).addClass("select2--processed").each(((t,e)=>{$(e).data("select2",new j(this.adminController,e))})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Sortable",(function(t){return new class{constructor(t){return t.onRefreshUi(((t,e)=>{this.init(e)})),this}init(t){return $(".js-admin-sortable:not(.js-admin-sortable--processed)",t).addClass("js-admin-sortable--processed").each((function(){let t=$(this),e=t.data("handle")||null,i=t.data("axis")||"y",n=t.data("containment")||"parent";t.sortable({handle:e,axis:i,containment:n,forceHelperSize:!0,helper:function(t,e){let i=e.children(),n=e.clone();return n.children().each((function(t){$(this).width(i.eq(t).outerWidth())})),n},stop:function(){t.trigger("sortable:sort")}}).on("sortable:sort",(()=>{t.find(".js-admin-sortable__order").each((function(t){$(this).val(t)}))})),e&&t.find(e).addClass("js-admin-sortable__handle")})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Stripes",(function(t){return new class{constructor(t){return t.onRefreshUi(((t,e)=>{this.init(e)})),this}init(t){return $("fieldset,.fieldset",t).each((function(){$("div.field",this).removeClass("odd even"),$("div.field:visible:odd",this).addClass("odd"),$("div.field:visible:even",this).addClass("even")})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Tabs",(function(t){return new class{constructor(t){return this.adminController=t,this.groups={},this.adminController.onRefreshUi(((t,e)=>{this.init()})),this}init(){this.prepareDomElements().instantiateTabs();for(let t in this.groups)this.groups.hasOwnProperty(t)&&this.groups[t].setDefaultActiveTab().setControlsWithErrors();return this}prepareDomElements(){let t=["ul.tabs","section.tabs"];for(let e=0;e<t.length;e++){let i=0,n=document.querySelectorAll(t[e]+":not(.ready)");for(let t=0;t<n.length;t++)void 0===n[t].dataset.tabgroup&&n[t].setAttribute("data-tabgroup","tab-group-"+i++)}return this}instantiateTabs(){let t,e,i,n,r;for(t=document.querySelectorAll("ul.tabs:not(.ready)"),i=0;i<t.length;i++){for(n=t[i].dataset.tabgroup,this.groups.hasOwnProperty(n)||(this.groups[n]=new N(n,this.adminController)),e=t[i].querySelectorAll("li.tab"),r=0;r<e.length;r++)this.groups[n].addControl(new L(this.groups[n],e[r]));t[i].classList.add("ready")}for(t=document.querySelectorAll("section.tabs:not(.ready)"),i=0;i<t.length;i++){for(n=t[i].dataset.tabgroup,e=t[i].querySelectorAll("div.tab-page"),r=0;r<e.length;r++)this.groups[n].addPanel(new U(this.groups[n],e[r]));t[i].classList.add("ready")}return this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"TimeCode",(function(t){return new class{constructor(t){return this.adminController=t,this.instances=[],this.adminController.onRefreshUi(((t,e)=>{this.init(e)})),this}init(t){let e=$(".js-timecode:not(.js-timecode--processed)").addClass("js-timecode--processed");e.length&&(this.adminController.log(`Found ${e.length} new timecode inputs`),e.each(((t,e)=>{this.instances.push(new R(this.adminController,$(e)))})))}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Tipsy",(function(t){return new class{constructor(t){return t.onRefreshUi(((t,e)=>{this.init(e)})),this}init(t){return $("*[rel=tipsy]:not(.drunk)",t).addClass("drunk").tipsy({opacity:.85}),$("*[rel=tipsy-html]:not(.drunk)",t).addClass("drunk").tipsy({opacity:.85,html:!0}),$("*[rel=tipsy-right]:not(.drunk)",t).addClass("drunk").tipsy({opacity:.85,gravity:"w"}),$("*[rel=tipsy-left]:not(.drunk)",t).addClass("drunk").tipsy({opacity:.85,gravity:"e"}),$("*[rel=tipsy-top]:not(.drunk)",t).addClass("drunk").tipsy({opacity:.85,gravity:"s"}),$("*[rel=tipsy-bottom]:not(.drunk)",t).addClass("drunk").tipsy({opacity:.85,gravity:"n"}),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Toggles",(function(t){return new class{constructor(t){return t.onRefreshUi(((t,e)=>{this.init(e)})).onDestroyUi(((t,e)=>{this.destroy(e)})),this}init(t){return $(".form-bool:not(.toggled)",t).each((function(){$(this).data("instance",new M($(this)))})),this}destroy(t){return $(".form-bool.toggled",t).each(((t,e)=>{$(e).data("instance").destroy()})),this}}(t)})).registerPlugin(window.NAILS.ADMIN.namespace,"Wysiwyg",(function(t){return new class{constructor(t){return this.ready=!1,this.adminController=t,this.config={basic:window.NAILS.URL+"js/ckeditor.config.basic.min.js",default:window.NAILS.URL+"js/ckeditor.config.default.min.js"},t.onRefreshUi(((t,e)=>{this.init(e)})).onDestroyUi(((t,e)=>{this.destroy(e)})),$.ajax({url:window.SITE_URL+"api/admin/ckeditor/configs"}).done((t=>{this.config.basic=t.data.basic,this.config.default=t.data.default,this.ready=!0,this.adminController.log("Ready"),this.init(document)})).fail((t=>{this.adminController.warn("Failed to fetch configs. Falling back to default configuration"),this.ready=!0,this.adminController.log("Ready"),this.init(document)})),this}init(t){return this.ready&&(this.adminController.log("Initiating new WYSIWYG",t),$("textarea.wysiwyg:not(.wysiwyged)",t).each(((t,e)=>{$(e).data("instance",new D(this.adminController,$(e),this.config))}))),this}destroy(t){return $("textarea.wysiwyg.wysiwyged",t).each(((t,e)=>{$(e).data("instance").destroy()})),this}}(t)}))})()})();